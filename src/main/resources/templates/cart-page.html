<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Amazin Bookstore</title>

    <!-- Use Tailwind for CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="change-order-amount.js"></script>
</head>
<body>
    <!-- Include header at top of page -->
    <div th:insert="~{header :: CartHeader}"></div>

    <!-- Cart table for books -->
    <div>
        <table th:unless="${books == null || books.isEmpty()}" class="w-full">
            <thead>
            <tr>
                <th></th>
                <th>ISBN</th>
                <th>Title</th>
                <th>Order Amount</th>
                <th>Actions</th>
            </tr>
            </thead>

            <tbody class="text-center">
            <tr th:each="book : ${books.keySet()}">
                <td class="w-16 h-16">
                    <a>
                        <img th:src="${book.getImageUrl()}">
                    </a>
                </td>
                <td>
                    <a th:text="${book.getIsbn()}" />
                </td>
                <td>
                    <a th:text="${book.getTitle()}" />
                </td>
                <td>
                    <a th:text="${books.get(book)}" />
                    <form action="/cart/changeOrdAmo" id="changeOrderForm" method="POST">
                        <input name="cartId" type="hidden"th:value="${cartId}">
                        <input name="bookId" type="hidden"th:value="${book.getId()}">
                        <input name="orderAmount" type="number" id="orderAmount"th:value="${books.get(book)}">
                    </form>
                </td>
                <td>
                    <form action="/cart/remove" method="DELETE">
                        <input name="cartId" type="hidden"th:value="${cartId}">
                        <input name="bookId" type="hidden"th:value="${book.getId()}">
                        <button class="ease-in-out duration-300 hover:bg-blue-800 hover:text-white border-blue-800 border-2 rounded-md px-4 py-1 ml-2">Remove</button>
                    </form>
                </td>
            </tr>
            </tbody>
            <div>
                <form action="/cart/clear" method="DELETE">
                    <input name="cartId" type="hidden"th:value="${cartId}">
                    <button class="ease-in-out duration-300 hover:bg-blue-800 hover:text-white border-blue-800 border-2 rounded-md px-4 py-1 ml-2">Clear cart</button>
                </form>
                <button class="ease-in-out duration-300 hover:bg-blue-800 hover:text-white border-blue-800 border-2 rounded-md px-4 py-1 ml-2">Checkout</button>
            </div>
        </table>
        <p th:if="${books == null || books.isEmpty()}">Cart is Empty</p>
    </div>
</body>
</html>